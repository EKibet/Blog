{% extends 'base.html' %}

{% import 'macros.html' as macro %}
{% block content %}
<script type="text/javascript">
  submitcomment=(postid)=>{
    $.post('/comments/'+postid, $('form#comment'+postid).serialize(),(data)=>{
      $(data).hide().appendTo($('#comments'+postid)).show('fast');
      count=$('#commentscount'+postid)
      count.text(parseInt(count.text())+1)
    });
    [...$(".commentinput")].forEach(c=>c.value='')
  }
</script>
<div class="form">
    <h2>Motion Blog</h2>
    <form action="{{url_for('main.writer_dashboard')}}" method="post" novalidate>
          {{ PostForm.hidden_tag() }}
          {{ PostForm.title.label }}<br>
          {{ PostForm.title(size=32) }}<br>
          {% for error in PostForm.title.errors %}
          <span style="color: red;">*{{ error }}*</span>
          {% endfor %}
          {{ PostForm.category.label }}<br>
          {{ PostForm.category }}<br>
          {% for error in PostForm.category.errors %}
          <span style="color: red;">*{{ error }}*</span>
          {% endfor %}
          {{ PostForm.post.label }}<br>
          {{ PostForm.post(size=32) }}<br>
          {% for error in PostForm.post.errors %}
          <span style="color: red;">*{{ error }}*</span>
          {% endfor %}  
          {{ PostForm.submit() }}
          </form>
  </div>

{% if type=='post' %}
  {{ macro.displayposts(posts,current_user) }}
{% else %}
  {{ macro.displaycomments(comments) }}
{% endif %}


{%endblock%}